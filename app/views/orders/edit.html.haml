.container
  .row.text-center
    %h2.text-center
      Checkout
    .btn-group.btn-group-lg{role: "group"}
      = link_to 'Address', '#', :class => "btn btn-primary"
      = link_to 'Delivery', '#', :class => "btn btn-primary"
      = link_to 'Payment', '#', :class => "btn btn-primary"
      = link_to 'Confirm', '#', :class => "btn btn-primary"
      = link_to 'Complete', '#', :class => "btn btn-default"
  .row
    %br
    .col-md-3.col-sm-3
      %h4
        Billing Address 
        = link_to '(edit)', edit_order_address_path(@order)
      %p
        = current_user.addresses.find_by(type: 'BillingAddress').firstname
        = current_user.addresses.find_by(type: 'BillingAddress').lastname
        %br
        = current_user.addresses.find_by(type: 'BillingAddress').address
        %br
        = current_user.addresses.find_by(type: 'BillingAddress').zipcode
        %br
        = current_user.addresses.find_by(type: 'BillingAddress').city
        %br
        = current_user.addresses.find_by(type: 'BillingAddress').phone
        %br
        = Country.find(current_user.addresses.find_by(type: 'BillingAddress').country).name
    .col-md-3.col-sm-3
      %h4
        Shipping Address 
        = link_to '(edit)', editshipping_order_address_path(@order)
      %p
        = @order.address.firstname
        = @order.address.lastname
        %br
        = @order.address.address
        %br
        = @order.address.zipcode
        %br
        = @order.address.city
        %br
        = @order.address.phone
        %br
        = Country.find(@order.address.country).name
    .col-md-3.col-sm-3
      %h4
        Shipments
        = link_to '(edit)', order_shippings_path(@order)
      %p
        = @order.shipping.company
        %br
        = @order.shipping.costs
    .col-md-3.col-sm-3
      %h4
        Payment Information
        = link_to '(edit)', edit_order_credit_card_path(@order)
      %p
        = @order.credit_card.number
        %br
        = @order.credit_card.expiration_month
        #{"/"}
        = @order.credit_card.expiration_year
  
  .row
    .col-md-12
      .thumbnail
        .caption-full
          %h2
            = "Order##{@order.id}"
            %small
              %i
                = @order.aasm.human_state
          - if @order.order_items.empty?
            %h2
              No items.
          - else
            %table.table.table-hover                  
              %thead        
                %th.col-md-1
                  Cover
                %th.col-md-4
                  Book
                %th.col-md-4
                  Price
                %th.col-md-1
                  Qty
                %th.col-md-2
                  Total
              %tbody
                - @order.order_items.each do |item|
                  %tr
                    %td
                      = image_tag(item.book.img)
                    %td
                      = item.book.title
                    %td
                      $#{item.book.price}
                    %td
                      = item.qty
                    %td
                      $#{item.price * item.qty}
                %tr.line
                  %td{colspan: 2}
                  %td.text-right{colspan: 2}
                    %strong
                      Subtotal:
                      %br
                      Shipping:
                  %td
                    = number_to_currency(@order.subtotal)
                    %br
                    = number_to_currency(@order.shipping.costs)
                %tr
                  %td{colspan: 2}
                  %td.text-right{colspan: 2}
                    %strong
                      Order total:
                  %td
                    = number_to_currency(@order.total_price + @order.shipping.costs)
  .row
    .col-md-4
    .col-md-4
      = link_to 'Place order', completed_order_path, method: :post, :class => "btn btn-success btn-lg btn-block"
    .col-md-4
